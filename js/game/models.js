/*

@_______________________No_Thrones_________________________@
@__________________________by______________________________@
@_______________________Rory_Duncan________________________@
@             http://www.github.com/RoryDuncan             @
*/

/*
@class Cube
@level atomic, graphical
@params [Object] geometry, [Object] material, [Object] position
*/

var Cube, Entity;

Cube = (function() {

  function Cube(geometry, material, position) {
    this.geometry = new THREE.CubeGeometry(geometry.width, geometry.height, geometry.depth);
    this.material = new THREE.MeshLambertMaterial(material);
    this.mesh = new THREE.Mesh(this.geometry, this.material);
    this.mesh.position = position || new THREE.Vector3(0, 0, 0);
    _.bindAll(this, "addToScene", "setPosition");
  }

  Cube.prototype.from = {};

  Cube.prototype.addToScene = function() {
    return pointer.scene.add(this.mesh);
  };

  Cube.prototype.setPosition = function(x, y, z) {
    return this.mesh.position.set(x, y, z);
  };

  return Cube;

})();

/*
@class Entity
@level atomic, graphical
@ConstructorParams name, path
*/


Entity = (function() {

  function Entity(name, path) {
    var entity, source, texture;
    _.bindAll(this, "addToScene", "adjust", "loaded");
    entity = this;
    this.name = name || "";
    source = path;
    texture = new THREE.TextureLoader;
    texture.load(source);
    texture.addEventListener("load", this.loaded);
  }

  Entity.prototype.addToScene = function() {
    console.log("Adding ", this);
    this.adjust();
    pointer.scene.add(this.sprite);
    return console.log("Entity \"" + this.name + "\" added to scene");
  };

  Entity.prototype.adjust = function() {
    console.log("adjusting:", this.sprite);
    this.sprite.scale.x = this.sprite.scale.z = this.sprite.scale.y = 1 * 50;
    return this.sprite.position.set(0, 20, 0);
  };

  Entity.prototype.loaded = function(e) {
    var h, material, w;
    this.texture = e.content;
    h = this.texture.image.naturalHeight;
    w = this.texture.image.naturalWidth;
    material = new THREE.SpriteMaterial({
      map: this.texture,
      useScreenCoordinates: false,
      color: 0xffffff,
      fog: true
    });
    this.material = material;
    /*
    
    @geometry = new THREE.PlaneGeometry(w, h)
    
    @sprite = new THREE.Mesh @geometry, @material
    @sprite.doubleSided = true
    */

    this.sprite = new THREE.Sprite(this.material);
    return this.addToScene();
  };

  return Entity;

})();

// Generated by CoffeeScript 1.5.0-pre
